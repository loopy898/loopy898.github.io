<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222"><meta name="generator" content="Hexo 7.3.0">

  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.7.2/css/all.min.css" integrity="sha256-dABdfBfUoC8vJUBOwGVdm8L9qlMWaHTIfXt+7GnZCIo=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">

<script class="next-config" data-name="main" type="application/json">{"hostname":"loopy898.github.io","root":"/","images":"/images","scheme":"Muse","darkmode":false,"version":"8.23.2","exturl":false,"sidebar":{"position":"left","width_expanded":320,"width_dual_column":240,"display":"post","padding":18,"offset":12},"hljswrap":true,"codeblock":{"theme":{"light":"default","dark":"stackoverflow-dark"},"prism":{"light":"prism","dark":"prism-dark"},"copy_button":{"enable":false,"style":null},"fold":{"enable":false,"height":500},"language":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":false,"duration":200,"transition":{"menu_item":"fadeInDown","post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"i18n":{"placeholder":"Searching...","empty":"We didn't find any results for the search: ${query}","hits_time":"${hits} results found in ${time} ms","hits":"${hits} results found"}}</script><script src="/js/config.js" defer></script>

    <meta property="og:type" content="website">
<meta property="og:title" content="Hexo">
<meta property="og:url" content="https://loopy898.github.io/index.html">
<meta property="og:site_name" content="Hexo">
<meta property="og:locale" content="en_US">
<meta property="article:author" content="loopy">
<meta name="twitter:card" content="summary">


<link rel="canonical" href="https://loopy898.github.io/">


<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":true,"isPost":false,"lang":"en","comments":"","permalink":"","path":"index.html","title":""}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>Hexo</title>
  








  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous" defer></script>
<script src="/js/utils.js" defer></script><script src="/js/motion.js" defer></script><script src="/js/sidebar.js" defer></script><script src="/js/next-boot.js" defer></script>

  






  





  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <div class="column">
      <header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar" role="button">
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <h1 class="site-title">Hexo</h1>
      <i class="logo-line"></i>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger" aria-label="Search" role="button">
    </div>
  </div>
</div>







</header>
        
  
  <aside class="sidebar">

    <div class="sidebar-inner sidebar-overview-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">loopy</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">1</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
        <span class="site-state-item-count">1</span>
        <span class="site-state-item-name">categories</span>
      </div>
      <div class="site-state-item site-state-tags">
        <span class="site-state-item-count">1</span>
        <span class="site-state-item-name">tags</span>
      </div>
  </nav>
</div>

        </div>
      </div>
    </div>

    
  </aside>


    </div>

    <div class="main-inner index posts-expand">

    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://loopy898.github.io/2025/07/15/2020changan/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="loopy">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content=" | Hexo">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2025/07/15/2020changan/" class="post-title-link" itemprop="url">2020长安杯总结</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2025-07-15 00:00:00" itemprop="dateCreated datePublished" datetime="2025-07-15T00:00:00+08:00">2025-07-15</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2025-07-30 22:44:28" itemprop="dateModified" datetime="2025-07-30T22:44:28+08:00">2025-07-30</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E6%AC%A2%E8%BF%8E%E6%9D%A5%E5%88%B0%E6%88%91%E7%9A%84%E7%AC%AC%E4%B8%80%E7%AF%87%E5%8D%9A%E5%AE%A2/" itemprop="url" rel="index"><span itemprop="name">欢迎来到我的第一篇博客</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h3 id="案情背景"><a href="#案情背景" class="headerlink" title="案情背景"></a>案情背景</h3><p>接群众举报，网站 “<a target="_blank" rel="noopener" href="http://www.kkzjc.co/">www.kkzjc.co</a>“ 可能涉嫌非法交易，警方调取了该网站的<u>云服务器镜像（检材1.DD）</u>，请对检材1进行分析，获取证据，并根据线索解锁更多检材，深入挖掘出更多与案件有关的信息。</p>
<h3 id="检材一-⭐💻🔍❌📕🖊-❀-🎀"><a href="#检材一-⭐💻🔍❌📕🖊-❀-🎀" class="headerlink" title="检材一.              ⭐💻🔍❌📕🖊 ❀ 🎀"></a>检材一.              ⭐💻🔍❌📕🖊 ❀ 🎀</h3><h4 id="1-检材-1-的操作系统版本是"><a href="#1-检材-1-的操作系统版本是" class="headerlink" title="1.检材 1 的操作系统版本是"></a>1.检材 1 的操作系统版本是</h4><p>将检材一镜像放到火眼取证中，点分析-系统信息。</p>
<p><img src="/images/1.png"></p>
<p><code>CentOS Linux 7.6.1810 (Core)，选D</code></p>
<h4 id="2-检材-1-中，操作系统的内核版本是"><a href="#2-检材-1-中，操作系统的内核版本是" class="headerlink" title="2.检材 1 中，操作系统的内核版本是 ()"></a>2.检材 1 中，操作系统的内核版本是 ()</h4><p>见上方系统信息</p>
<p><code>3.10.0</code></p>
<h4 id="3-检材-1-中磁盘包含一个-LVM-逻辑卷，该-LVM-开始的逻辑区块地址-LBA-是-答案格式：-“12345678”-纯数字"><a href="#3-检材-1-中磁盘包含一个-LVM-逻辑卷，该-LVM-开始的逻辑区块地址-LBA-是-答案格式：-“12345678”-纯数字" class="headerlink" title="3.检材 1 中磁盘包含一个 LVM 逻辑卷，该 LVM 开始的逻辑区块地址 (LBA) 是 () (答案格式：  “12345678” 纯数字)"></a>3.检材 1 中磁盘包含一个 <span style="color:blue">LVM 逻辑卷</span>，该 LVM 开始的逻辑区块地址 (LBA) 是 () (答案格式：  “12345678” 纯数字)</h4><p>分析：LVM（<strong>Logical Volume Manager</strong>，逻辑卷管理器）是 Linux 系统下用于管理磁盘和存储的高级工具。</p>
<p>见分区详情</p>
<p><img src="/images/3.png"></p>
<p>参考其他wp时，发现也可以将服务器dd镜像导入虚拟机，</p>
<p>用命令linux基本命令<mark>fdisk -l</mark>，列出所有磁盘分区信息。</p>
<p><img src="/images/2.png"></p>
<p>由图可得LBA是<code>2099200扇区</code>。</p>
<h4 id="4-检材-1-中网站-“www-kkzjc-com“-对应-Web-服务对外开放的端口是"><a href="#4-检材-1-中网站-“www-kkzjc-com“-对应-Web-服务对外开放的端口是" class="headerlink" title="4.检材 1 中网站 “www.kkzjc.com“ 对应 Web 服务对外开放的端口是"></a>4.检材 1 中网站 “<a target="_blank" rel="noopener" href="http://www.kkzjc.com/">www.kkzjc.com</a>“ 对应 Web 服务对外开放的端口是</h4><p>要分析服务器上运行的web服务，找出对外开放的端口。检查web服务器配置，Nginx 的配置文件通常位于：</p>
<ul>
<li><strong>路径</strong>：<code>/etc/nginx/conf.d/</code><ul>
<li>这是 Nginx 的标准配置目录，用于存放各个网站的独立配置文件。</li>
</ul>
</li>
<li><strong>列出的文件</strong>：<ul>
<li><code>default.conf</code>：默认网站配置（通常作为兜底或未匹配域名时的响应）。</li>
<li><code>www.6688jia.com</code>、<code>www.9797jjy.com</code>、<code>www.kkzjc.com</code>：<strong>3 个独立的网站配置文件</strong>。</li>
</ul>
</li>
</ul>
<p>配置文件下找到<code>www.kkzjc.com</code> 的配置文件，打开，</p>
<p><img src="/images/7.png"></p>
<p>发现该网站监听的是<code>32000端口</code>。</p>
<h5 id="为什么一个服务器能托管多个网站？"><a href="#为什么一个服务器能托管多个网站？" class="headerlink" title="为什么一个服务器能托管多个网站？"></a>为什么一个服务器能托管多个网站？</h5><p>这是 <strong>虚拟主机（Virtual Host）</strong> 技术的典型应用，通过以下方式实现：</p>
<ol>
<li><strong>基于域名区分</strong>（最常用）：<ul>
<li>所有网站共享同一 IP 和端口（如 80），但通过 <code>server_name</code> 区分请求的域名。</li>
<li>示例：<ul>
<li>访问 <code>http://www.kkzjc.com</code> → 由 <code>www.kkzjc.com</code> 配置处理。</li>
<li>访问 <code>http://www.9797jjy.com</code> → 由 <code>www.9797jjy.com</code> 配置处理。</li>
</ul>
</li>
</ul>
</li>
<li><strong>基于端口区分</strong>：<ul>
<li>不同网站监听不同端口（如 80、8080、8888），但需用户手动指定端口。</li>
</ul>
</li>
</ol>
<h4 id="5-检材-1-所在的服务器共绑定了几个对外开放的域名"><a href="#5-检材-1-所在的服务器共绑定了几个对外开放的域名" class="headerlink" title="5. 检材 1 所在的服务器共绑定了几个对外开放的域名"></a>5. 检材 1 所在的服务器共绑定了几个对外开放的域名</h4><p><code>3</code></p>
<p>同上图，有三个对外开放的域名。</p>
<h4 id="6-检材-1-所在服务器的原始IP地址是"><a href="#6-检材-1-所在服务器的原始IP地址是" class="headerlink" title="6. 检材 1 所在服务器的原始IP地址是"></a>6. 检材 1 所在服务器的原始IP地址是</h4><p>从检材二的连接中得到，</p>
<p><img src="/images/14.png"></p>
<p>（后来发现，也可以从docker的日志中找：8091端口是在docker中，别人通过web访问时自己的ip会被记录)</p>
<p><code>192.168.99.3</code></p>
<h4 id="7-嫌疑人曾远程登录检材-1-所在的服务器，分析并找出其使用的-IP-地址是"><a href="#7-嫌疑人曾远程登录检材-1-所在的服务器，分析并找出其使用的-IP-地址是" class="headerlink" title="7. 嫌疑人曾远程登录检材 1 所在的服务器，分析并找出其使用的 IP 地址是"></a>7. 嫌疑人曾远程登录检材 1 所在的服务器，分析并找出其使用的 IP 地址是</h4><p>❓远程登录：last命令，</p>
<p><img src="/images/13.png"></p>
<p>案发时间只有一个ip反复登录过。</p>
<p><code>192.168.99.222</code></p>
<h4 id="8-反向代理-“www-kkzjc-com“-转发的后台-IP-地址"><a href="#8-反向代理-“www-kkzjc-com“-转发的后台-IP-地址" class="headerlink" title="8. 反向代理 “www.kkzjc.com“ 转发的后台 IP 地址"></a>8. 反向代理 “<a target="_blank" rel="noopener" href="http://www.kkzjc.com/">www.kkzjc.com</a>“ 转发的后台 IP 地址</h4><p><img src="/images/8.png" alt="8"></p>
<p>打开 “<a target="_blank" rel="noopener" href="http://www.kkzjc.com/">www.kkzjc.com</a>“ 文件，如上图，该网站反向代理，将请求转发到127.0.0.1:8091，就是本机的8091端口，（且三个网站都是将请求转发到8091端口上）</p>
<p>直接检查端口，netstat -napt（一个组合了多个选项的 <code>netstat</code> 命令，用于查看网络连接、端口和进程信息），发现没有8091端口的信息。这是因为docker没有开，</p>
<p>需要<code>systemctl start docker</code></p>
<p><img src="/images/15.png"></p>
<p>这样才顺利看到了8091端口。</p>
<p><code>dockers ps</code>：检查正在运行的容器，发现宿主机 8091 端口映射到容器内部的 80 端口。</p>
<p><img src="/images/11.png" alt="11"></p>
<p><span style="color:blue">进入容器交互终端：docker exec -it 08 &#x2F;bin&#x2F;bash</span></p>
<p>在docker的容器里面，发现它里面也有nginx，依然是主配置文件里include一个路径，打开这个路径&#x2F;etc&#x2F;nginx&#x2F;conf.d，里面只有hl.conf，查看：more hl.conf。</p>
<p><img src="/images/12.png" alt="12"></p>
<p>结果如图，找到了最终转发的ip为192.168.1.176。即docker的80端口再作为被监听的部分，将请求转发到192.168.1.176的80端口上。</p>
<p>感觉有点复杂，像二级跳板一样，，，最开始我写的就是本机（127.0.0.1:8091）</p>
<p><code>192.168.1.176</code></p>
<h4 id="9-题目-7-中的-IP-地址在检材-1-中出现的次数"><a href="#9-题目-7-中的-IP-地址在检材-1-中出现的次数" class="headerlink" title="9. 题目 7 中的 IP 地址在检材 1 中出现的次数"></a>9. 题目 7 中的 IP 地址在检材 1 中出现的次数</h4><p>❓15</p>
<h3 id="检材二"><a href="#检材二" class="headerlink" title="检材二."></a>检材二.</h3><p>pc机是嫌疑人的机器，本机痕迹不多，分析其虚拟机，将其导出并移除加密，放到火眼仿真中。在VM中运行Docker（云服务器的常见做法）。</p>
<h4 id="10-检材-2-的原始磁盘-SHA256-值"><a href="#10-检材-2-的原始磁盘-SHA256-值" class="headerlink" title="10. 检材 2 的原始磁盘 SHA256 值"></a>10. 检材 2 的原始磁盘 SHA256 值</h4><p><code>2D926D5E1CFE27553AE59B6152E038560D64E7837ECCAD30F2FBAD5052FABF37</code></p>
<h4 id="11-检材-2-所在计算机的-OS-内部版本号"><a href="#11-检材-2-所在计算机的-OS-内部版本号" class="headerlink" title="11. 检材 2 所在计算机的 OS 内部版本号"></a>11. 检材 2 所在计算机的 OS 内部版本号</h4><p><code>18363.1082</code></p>
<h4 id="12-检材-2-计算机最后一次正常关机时间"><a href="#12-检材-2-计算机最后一次正常关机时间" class="headerlink" title="12. 检材 2 计算机最后一次正常关机时间"></a>12. 检材 2 计算机最后一次正常关机时间</h4><p><code>2020-09-22 13:15:34</code></p>
<h4 id="13-检材-2-中-VMware-的安装时间"><a href="#13-检材-2-中-VMware-的安装时间" class="headerlink" title="13. 检材 2 中 VMware 的安装时间"></a>13. 检材 2 中 VMware 的安装时间</h4><p><code>2020-09-18 17:57:13</code></p>
<h4 id="14-检材-2-中，VMware-exe-共计启动过几次"><a href="#14-检材-2-中，VMware-exe-共计启动过几次" class="headerlink" title="14. 检材 2 中，VMware.exe 共计启动过几次"></a>14. 检材 2 中，VMware.exe 共计启动过几次</h4><p>❓</p>
<p>在应用程序执行记录中，没有直接找到vmware.exe，但是能看到.vmui的执行次数是8次。</p>
<p><code>.vmui</code> 的作用：此文件是虚拟机界面配置（如窗口布局、工具栏设置），仅当用户通过 <code>vmware.exe</code> 打开特定虚拟机时被加载。</p>
<p>所以我觉得vmware.exe执行次数也是8）</p>
<p><img src="/images/4.png"></p>
<p><mark>查找prefetch记录</mark>：无论通过快捷方式、开始菜单、命令行还是其他方式启动<code>vmware.exe</code>，只要进程真正执行，Windows必定会在Prefetch中生成&#x2F;更新记录。</p>
<p><strong>Prefetch文件</strong>：</p>
<ul>
<li>路径：<code>C:\Windows\Prefetch\</code></li>
<li>查找格式为<code>VMWARE.EXE-&lt;哈希值&gt;.pf</code>的文件(如<code>VMWARE.EXE-01234567.pf</code>)</li>
</ul>
<p>Prefetch 文件名的哈希值（<code>XXXXXXXX</code>部分）是通过<strong>程序完整路径</strong>计算得出的</p>
<p>文件-c-windows-prefetch,只看到一个VMWARE.EXE-C567918C.pf记录，说明它只有一个路径。分析这个文件？？</p>
<p><img src="/images/6.png"></p>
<p><code>8</code></p>
<h4 id="15-嫌疑人通过-Web-方式，从检材-2-访问检材-1-的网站，连接的目标端口"><a href="#15-嫌疑人通过-Web-方式，从检材-2-访问检材-1-的网站，连接的目标端口" class="headerlink" title="15. 嫌疑人通过 Web 方式，从检材 2 访问检材 1 的网站，连接的目标端口"></a>15. 嫌疑人通过 Web 方式，从检材 2 访问检材 1 的网站，连接的目标端口</h4><p><code>8091</code></p>
<h4 id="16-接-15-题，该端口上运行的进程的程序名称"><a href="#16-接-15-题，该端口上运行的进程的程序名称" class="headerlink" title="16. 接 15 题，该端口上运行的进程的程序名称"></a>16. 接 15 题，该端口上运行的进程的程序名称</h4><p><code>docker-proxy</code>，见第8题图。</p>
<h4 id="17-嫌疑人从检材-2-上访问该网站，所使用的域名"><a href="#17-嫌疑人从检材-2-上访问该网站，所使用的域名" class="headerlink" title="17. 嫌疑人从检材 2 上访问该网站，所使用的域名"></a>17. 嫌疑人从检材 2 上访问该网站，所使用的域名</h4><p>见第6题图，chrome浏览器中记录了通过web访问时的域名。</p>
<p>或：搜一下关键词8091</p>
<p><code>www.sdhj.com</code></p>
<h4 id="18-检材-2-中嫌疑人使用的微信-ID"><a href="#18-检材-2-中嫌疑人使用的微信-ID" class="headerlink" title="18. 检材 2 中嫌疑人使用的微信 ID"></a>18. 检材 2 中嫌疑人使用的微信 ID</h4><p>检材二c盘中有手机备份，导出-添加为新检材。（检材2在虚拟机中仿真更容易看到）</p>
<p><code>sstt119999</code></p>
<h4 id="19-分析检材-2，嫌疑人为推广其网站，与广告位供应商沟通时使用的通联工具的名称为"><a href="#19-分析检材-2，嫌疑人为推广其网站，与广告位供应商沟通时使用的通联工具的名称为" class="headerlink" title="19. 分析检材 2，嫌疑人为推广其网站，与广告位供应商沟通时使用的通联工具的名称为"></a>19. 分析检材 2，嫌疑人为推广其网站，与广告位供应商沟通时使用的通联工具的名称为</h4><p><code>Telegram</code></p>
<h4 id="20-分析检材-2，嫌疑人与供应商交易使用的虚拟货币名称"><a href="#20-分析检材-2，嫌疑人与供应商交易使用的虚拟货币名称" class="headerlink" title="20. 分析检材 2，嫌疑人与供应商交易使用的虚拟货币名称"></a>20. 分析检材 2，嫌疑人与供应商交易使用的虚拟货币名称</h4><p><code>dogecoin</code></p>
<h4 id="21-上述交易的首款地址"><a href="#21-上述交易的首款地址" class="headerlink" title="21. 上述交易的首款地址"></a>21. 上述交易的首款地址</h4><p><code>DPBEgbwap7VW5HbNdGi9TyKJbqTLWYYkvf</code></p>
<p>在聊天记录中能直接看到</p>
<h4 id="22-上述交易的交易时间"><a href="#22-上述交易的交易时间" class="headerlink" title="22. 上述交易的交易时间"></a>22. 上述交易的交易时间</h4><p>用上面的收款地址去区块链浏览器搜索，页面会显示该地址的所有转入&#x2F;转出交易</p>
<p><img src="/images/16.png"></p>
<p>❓2020-9-20 04:19:46</p>
<p>（为什么我查的和答案不一样，答案是十二点多</p>
<h4 id="23-上述交易中支付货币的数量"><a href="#23-上述交易中支付货币的数量" class="headerlink" title="23. 上述交易中支付货币的数量"></a>23. 上述交易中支付货币的数量</h4><p><code>4000</code></p>
<p>见上图</p>
<p>（我最开始想的是1800，三个月定金。以实际到账为准</p>
<h4 id="24-检材-2-中嫌疑人使用的虚拟机的加密密码"><a href="#24-检材-2-中嫌疑人使用的虚拟机的加密密码" class="headerlink" title="24. 检材 2 中嫌疑人使用的虚拟机的加密密码"></a>24. 检材 2 中嫌疑人使用的虚拟机的加密密码</h4><p>检材2放入火眼仿真一下，打开虚拟机发现被加密了。</p>
<p><img src="/images/17.png" alt="17"></p>
<p>把虚拟机导出，整个文件夹导出。</p>
<p><img src="/images/21.png"></p>
<p>聊天记录中提到，嫌疑人忘记虚拟机密码，对方说github上有解决方案， 所以我搜索了有关github的内容，发现提到了pyvmx-craker，在github上下载了这个工具，自带wordlist。</p>
<p><img src="/images/18.png" alt="18"></p>
<p>阅读readme，将检材2中的虚拟机配置文件.vmx复制到该脚本路径下，运行脚本。</p>
<p>（或者直接把所有导出都放到一个文件夹下）</p>
<p><img src="/images/19.png" alt="1-9"></p>
<p><img src="/images/20.png"></p>
<p>爆破出来密码是<code>zzzxxx</code>。</p>
<p>可是虚拟机登陆密码不知道，还是打不开。。</p>
<p><img src="/images/22.png"></p>
<p>怎么绕过密码？</p>
<p>用火眼仿真取证打开（镜像支持.vmdk）最开始虚拟机创建没成功，看了wp，要<span style="color:blue">先把虚拟机移除加密之后才可以给取证软件识别，如下图。</span>这样就可以成功用火眼仿真创建并打开虚拟机，用火眼取证分析.vmdk镜像。</p>
<p><img src="/images/26.png"></p>
<h4 id="25-检材-2-中嫌疑人发送给广告商的邮件附件中图片的-SHA256"><a href="#25-检材-2-中嫌疑人发送给广告商的邮件附件中图片的-SHA256" class="headerlink" title="25. 检材 2 中嫌疑人发送给广告商的邮件附件中图片的 SHA256"></a>25. 检材 2 中嫌疑人发送给广告商的邮件附件中图片的 SHA256</h4><p>图片就是”广告.jpg“,</p>
<p><img src="/images/24.png"></p>
<p>计算SHA256：certutil -hashfile “文件路径” SHA256</p>
<p><img src="/images/25.png"></p>
<p><code>cc7ea3ab90ab6b28417e08c715c243ce58ea76d71fd141b93f055a58e9ba561a</code></p>
<h4 id="26-检材-2-中，嫌疑人给广告商发送广告图片邮件的时间"><a href="#26-检材-2-中，嫌疑人给广告商发送广告图片邮件的时间" class="headerlink" title="26. 检材 2 中，嫌疑人给广告商发送广告图片邮件的时间"></a>26. 检材 2 中，嫌疑人给广告商发送广告图片邮件的时间</h4><p>见上图 <code>2020-9-20 12:53</code></p>
<h4 id="27-检材-2-中，嫌疑人的邮箱密码"><a href="#27-检材-2-中，嫌疑人的邮箱密码" class="headerlink" title="27. 检材 2 中，嫌疑人的邮箱密码"></a>27. 检材 2 中，嫌疑人的邮箱密码</h4><p><img src="/images/28.png"></p>
<p>导入虚拟机.vmdk为新检材后自动分析。</p>
<p><code>honglian7001</code></p>
<h4 id="28-检材-2-中，嫌疑人登录检材-1-使用的远程管理工具"><a href="#28-检材-2-中，嫌疑人登录检材-1-使用的远程管理工具" class="headerlink" title="28. 检材 2 中，嫌疑人登录检材 1 使用的远程管理工具"></a>28. 检材 2 中，嫌疑人登录检材 1 使用的远程管理工具</h4><p><code>Xshell 6</code></p>
<h4 id="29-检材-2-中，嫌疑人使用上述工具连接服务器的登录密码"><a href="#29-检材-2-中，嫌疑人使用上述工具连接服务器的登录密码" class="headerlink" title="29. 检材 2 中，嫌疑人使用上述工具连接服务器的登录密码"></a>29. 检材 2 中，嫌疑人使用上述工具连接服务器的登录密码</h4><p><img src="/images/29.png"></p>
<p>第6题，服务器ip为192.168.99.3，说明这条记录是嫌疑人用虚拟机连接到服务器。</p>
<p><code>qwer1234!@#$</code></p>
<h3 id="检材三"><a href="#检材三" class="headerlink" title="检材三."></a>检材三.</h3><p>该检材是一个 Windows Server 服务器，上面部署了一个 IIS 网站，</p>
<h4 id="30-检材-3-的原始磁盘-SHA256-值"><a href="#30-检材-3-的原始磁盘-SHA256-值" class="headerlink" title="30. 检材 3 的原始磁盘 SHA256 值"></a>30. 检材 3 的原始磁盘 SHA256 值</h4><p><code>FF593FCCB3770B8845A3334631F8E80807638EE722C5AA7B34E877589857C3BA</code></p>
<h4 id="31-检材-3-所在计算机的操作系统版本"><a href="#31-检材-3-所在计算机的操作系统版本" class="headerlink" title="31. 检材 3 所在计算机的操作系统版本"></a>31. 检材 3 所在计算机的操作系统版本</h4><p><code>Windows Server 2008 HPC Edition</code></p>
<h4 id="32-检材-3-中，部署的网站名称"><a href="#32-检材-3-中，部署的网站名称" class="headerlink" title="32. 检材 3 中，部署的网站名称"></a>32. 检材 3 中，部署的网站名称</h4><p><code>card</code></p>
<h4 id="33-检材-3-中，部署的网站的根目录"><a href="#33-检材-3-中，部署的网站的根目录" class="headerlink" title="33. 检材 3 中，部署的网站的根目录"></a>33. 检材 3 中，部署的网站的根目录</h4><p>网站的根目录：网站文件在服务器上的最顶层存储位置，也是网站访问的起点。服务器上的物理位置：根目录是服务器文件系统中存放网站所有文件的起始文件夹</p>
<p>基本设置中，可看到网站名称，物理路径。</p>
<p><img src="/images/32.png"></p>
<p><code>C:\inetpub\wwwroot\v7w</code></p>
<h4 id="34-检材-3-中，部署的网站绑定的端口"><a href="#34-检材-3-中，部署的网站绑定的端口" class="headerlink" title="34. 检材 3 中，部署的网站绑定的端口"></a>34. 检材 3 中，部署的网站绑定的端口</h4><p><img src="/images/31.png"></p>
<p><code>80</code></p>
<h4 id="35-检材-3-中，具备登录功能的代码页对应的文件名"><a href="#35-检材-3-中，具备登录功能的代码页对应的文件名" class="headerlink" title="35. 检材 3 中，具备登录功能的代码页对应的文件名"></a>35. 检材 3 中，具备登录功能的代码页对应的文件名</h4><p><img src="/images/35.png"></p>
<p><img src="/images/33.png"></p>
<p><span style="color:blue">查看网站目录：火眼中C：&#x2F;inetpub&#x2F;wwwroot&#x2F;v7w路径下文件，用资源管理器打开</span>（比在虚拟机里看起来方便，虚拟机工具不全，火眼磁盘是挂载出来的，可以直接映射出目录，这样就能用自己的电脑看这些文件）</p>
<p>先看<strong>Web.config</strong> ：是微软 IIS 服务器上用于配置 ASP.NET或 .NET Core 应用程序的核心配置文件。</p>
<p>第6题图：后台登录界面是dl，<strong>Web.config</strong>中，和dl有关的部分</p>
<p><img src="/images/34.png"></p>
<p>如果域名是dl，则重定向到dr&#x2F;login&#x2F;dllogin.aspx，即浏览器中打开…dl，相当于打开dllogin.aspx文件。</p>
<h4 id="36-检材-3-网站登录过程中，代码中对输入的明文密码作了追加什么字符串的处理"><a href="#36-检材-3-网站登录过程中，代码中对输入的明文密码作了追加什么字符串的处理" class="headerlink" title="36. 检材 3 网站登录过程中，代码中对输入的明文密码作了追加什么字符串的处理"></a>36. 检材 3 网站登录过程中，代码中对输入的明文密码作了追加什么字符串的处理</h4><p>打开dllogin.aspx文件，点击登录按钮时，触发submit()，前端对明文密码追加”OvO”，再提交到后台。</p>
<p><img src="/images/36.png"></p>
<p>也可以找到IE浏览器，访问历史记录中的localhost&#x2F;dl，看到登陆界面–f12查看源码。</p>
<p><img src="/images/37.png"></p>
<p><img src="/images/46.png"></p>
<p>还可以找出虚拟机ip，在自己本机浏览器访问对应的网站名分析登陆页面。</p>
<p><code>OvO</code></p>
<h4 id="37-检材-3-网站代码中，网站登录过程中调用的动态扩展库名称"><a href="#37-检材-3-网站代码中，网站登录过程中调用的动态扩展库名称" class="headerlink" title="37. 检材 3 网站代码中，网站登录过程中调用的动态扩展库名称"></a>37. 检材 3 网站代码中，网站登录过程中调用的动态扩展库名称</h4><p>引用了App_Web_dllogin.aspx配置文件（36题图），在bin中找，可得文件的完整名称。<code>App_Web_dllogin.aspx.7d7c2f33.dll</code></p>
<h4 id="38-检材-3-网站登录时后台对接收到的明文密码采用的加密算法"><a href="#38-检材-3-网站登录时后台对接收到的明文密码采用的加密算法" class="headerlink" title="38. 检材 3 网站登录时后台对接收到的明文密码采用的加密算法"></a>38. 检材 3 网站登录时后台对接收到的明文密码采用的加密算法</h4><p><img src="/images/39.png"></p>
<p>直接打开是乱码，需要用的dnspy对dll文件进行逆向。</p>
<p><img src="/images/38.png"></p>
<p>逆向后，代码展示了后台接收前端传来的用户名和密码之后的操作：对传递的参数进行AESE+base64+md5三次加密。</p>
<p><code>AESEncrypt</code></p>
<h4 id="39-检材-3-中，分析该网站连接的数据库地址"><a href="#39-检材-3-中，分析该网站连接的数据库地址" class="headerlink" title="39. 检材 3 中，分析该网站连接的数据库地址"></a>39. 检材 3 中，分析该网站连接的数据库地址</h4><p><img src="/images/40.png"></p>
<p>这一块是数据库的配置文件，也是加密的，如何解密，</p>
<p><img src="/images/41.png"></p>
<p>在 <code>DBcon</code> 类中最下面可以看到连接 sql 数据库的默认配置，但这里的密码不对。。（哦原来它只是默认配置</p>
<p><img src="/images/49.png"></p>
<p>DBcon中，这里的逻辑是：如果 <code>this.Conn</code> 为空，则使用默认的连接信息（红色框），但实际上 <code>this.Conn</code> 已经被赋值了（黄色框），也就是说我们需要利用 <code>AESDecrypt</code> 方法来解密这串信息，查看该方法，可以看到这是个 <code>Encryption</code> 类下的静态方法，可以直接通过 PowerShell 调用，但是需要注意调用静态方法必须使用方括号加上双冒号 <code>::</code> 的形式，而且要先在当前的 PowerShell 环境下引入这个动态链接库.</p>
<p>（用powershell，调用AESDecrypt方法，对DBManager.dll进行解密，得到数据库地址、密码、连接端口。）</p>
<p><code>192.168.1.174</code></p>
<h4 id="40-检材-3-中，网站连接数据库使用的密码"><a href="#40-检材-3-中，网站连接数据库使用的密码" class="headerlink" title="40. 检材 3 中，网站连接数据库使用的密码"></a>40. 检材 3 中，网站连接数据库使用的密码</h4><p><code>c4f2737e88</code></p>
<h4 id="41-检材-3-中，网站连接数据库服务器的端口"><a href="#41-检材-3-中，网站连接数据库服务器的端口" class="headerlink" title="41. 检材 3 中，网站连接数据库服务器的端口"></a>41. 检材 3 中，网站连接数据库服务器的端口</h4><p><code>1433</code></p>
<h3 id="检材四"><a href="#检材四" class="headerlink" title="检材四."></a>检材四.</h3><p>数据库服务器</p>
<h4 id="42-检材-4-的原始磁盘-SHA256-值"><a href="#42-检材-4-的原始磁盘-SHA256-值" class="headerlink" title="42. 检材 4 的原始磁盘 SHA256 值"></a>42. 检材 4 的原始磁盘 SHA256 值</h4><p><code>E5E548CCAECD02608A0E053A5C7DCDBFBDD4BE5B0E743EB9DC8E318C369BEBC8</code></p>
<h4 id="43-重构该网站，分析嫌疑用户的推广链接中参数里包含的-ID"><a href="#43-重构该网站，分析嫌疑用户的推广链接中参数里包含的-ID" class="headerlink" title="43. 重构该网站，分析嫌疑用户的推广链接中参数里包含的 ID"></a>43. 重构该网站，分析嫌疑用户的推广链接中参数里包含的 ID</h4><p>仿真后查看history，打开docker，发现没有正在运行中的容器，但有一个运行过的容器，端口是1433，说明数据库在 docker 中。</p>
<p><img src="/images/42.png"></p>
<p>需要重构网站：</p>
<p>通过检材 3 我们得知连接数据库的地址是 192.168.1.174，所以我们要先修改检材 4 的静态 IP：（仿真时默认DHCP，虚拟机ip不是由自己控制），</p>
<p>在 Linux 系统中，网络接口的配置文件通常位于 &#x2F;etc&#x2F;sysconfig&#x2F;network-scripts&#x2F;目录下，命名格式为 ifcfg-&lt;接口名&gt;。</p>
<p>重启后设置成功。</p>
<p><img src="/images/43.png"></p>
<p>将两台虚拟机绑定到同一虚拟网络并开启DHCP，使得检材4虚拟机可以ping通检材3，这样iis服务器和数据库就连通了。</p>
<p><img src="/images/44.png"></p>
<p>用之前38-40题答案可以连接数据库：</p>
<p><img src="/images/48.png"></p>
<p>在数据库里的用户中看到了嫌疑人账号，但是不知道他登录网站的密码（经过上面分析的三层加密），如何破解用户的登录密码并进入网站中呢？</p>
<p><img src="/images/45.png"></p>
<p>⭐有一个技巧，可以通过修改代码，登陆时弹出密码。</p>
<p>（本来密码不正确点登录会出现“用户名不正确”的提示）</p>
<p>在反编译的ocmd文件中，右键-编译类，把2处原内容改为加密后的text2。</p>
<p><img src="/images/50.png"></p>
<p>保存到桌面上，直接在资源管理器中无法替换，因为挂载时设置的是“只读”，所以要复制到虚拟机桌面上（先设置好让虚拟机和主机建立连接），然后在虚拟机目录下对应位置替换。</p>
<p><img src="/images/51.png"></p>
<p>并且在组件服务中，把.net服务提起来</p>
<p><img src="/images/52.png"></p>
<p>刷新网页，输入用户名liwente1314520，随便输密码123456，登录显示</p>
<p><img src="/images/53.png"></p>
<p>这就是123456加密后的哈希值，再去数据库用这个值把原有的替换掉，这样用户的密码被替换成123456了。</p>
<p><img src="/images/54.png"></p>
<p>⭐哦对，这里还要改一个域名控制的设置：修改web白名单</p>
<p>存储过程中，见文件PD_UserLogin，有限制域名，验证了dw-web库，所以dw-web库一定要设置白名单。</p>
<p><img src="/images/55.png"></p>
<p>改成ip再刷新网页。</p>
<p><img src="/images/56.png"></p>
<p>刷新虚拟机.net服务和网页，输入liwente1314520和123456即可成功登上网站后台，至此，网站重建完成。</p>
<p><img src="/images/57.png"></p>
<p><img src="/images/58.png"></p>
<p><code>abe6d2ee630379c3</code></p>
<h4 id="44-重构该网站，该网站后台的代理用户数量"><a href="#44-重构该网站，该网站后台的代理用户数量" class="headerlink" title="44. 重构该网站，该网站后台的代理用户数量"></a>44. 重构该网站，该网站后台的代理用户数量</h4><p>共三页，数一下。</p>
<p>26 </p>
<h4 id="45-重构该网站，该网站注册用户有过几个代理（包含删除的数据）"><a href="#45-重构该网站，该网站注册用户有过几个代理（包含删除的数据）" class="headerlink" title="45. 重构该网站，该网站注册用户有过几个代理（包含删除的数据）"></a>45. 重构该网站，该网站注册用户有过几个代理（包含删除的数据）</h4><p>网站页面上不显示删除的，在数据库里看，用户中有6个被删除的用户。</p>
<p><img src="/images/59.png"></p>
<p><code>32</code></p>
<h4 id="46-重构该网站，统计-2019-年-10-月-1-日后补发成功的金额总值"><a href="#46-重构该网站，统计-2019-年-10-月-1-日后补发成功的金额总值" class="headerlink" title="46. 重构该网站，统计 2019 年 10 月 1 日后补发成功的金额总值"></a>46. 重构该网站，统计 2019 年 10 月 1 日后补发成功的金额总值</h4><p>补发测试页面中，共有两千多页，该网站不支持导出功能，可以用网镜把它爬下来做成excel。</p>
<p>按要求时间过滤，有83页。将导出的excel中成功的筛选出求和。</p>
<p><img src="/images/60.png"></p>
<p><code>138408</code></p>
<h4 id="47-检材-4-中，对-“TX-IpLog”-表进行分析，所有在“武汉市”登录的次数"><a href="#47-检材-4-中，对-“TX-IpLog”-表进行分析，所有在“武汉市”登录的次数" class="headerlink" title="47. 检材 4 中，对 “TX_IpLog” 表进行分析，所有在“武汉市”登录的次数"></a>47. 检材 4 中，对 “TX_IpLog” 表进行分析，所有在“武汉市”登录的次数</h4><p>在数据库中，用sql语句查询：</p>
<p><img src="/images/61.png"></p>
<p><code>2829</code></p>
<h4 id="48-重构该网站，该嫌疑人下属代理-“liyun10”-账户下的余额"><a href="#48-重构该网站，该嫌疑人下属代理-“liyun10”-账户下的余额" class="headerlink" title="48. 重构该网站，该嫌疑人下属代理 “liyun10” 账户下的余额"></a>48. 重构该网站，该嫌疑人下属代理 “liyun10” 账户下的余额</h4><p>嫌疑人有很多下级代理，分别有下属代理的后台。</p>
<p><img src="/images/62.png"></p>
<p>但后台跳转有问题，缺少ip,在链接中补上后台ip就能跳转成功，从代理用户后台到用户管理后台。</p>
<p><img src="/images/63.png"></p>
<p>到这里后三题就能做出来了。</p>
<p><img src="/images/64.png"></p>
<p>账户余额：<code>1066449 元</code></p>
<h4 id="49-接上一题，该用户的推广-ID"><a href="#49-接上一题，该用户的推广-ID" class="headerlink" title="49. 接上一题，该用户的推广 ID"></a>49. 接上一题，该用户的推广 ID</h4><p><img src="/images/65.png"></p>
<p>网站管理员可以往其他网站中植入广告。</p>
<p><code>d0fdd7a9a010d37e</code></p>
<h4 id="50-接上一题，该代理商户的最后一次登陆时间"><a href="#50-接上一题，该代理商户的最后一次登陆时间" class="headerlink" title="50. 接上一题，该代理商户的最后一次登陆时间"></a>50. 接上一题，该代理商户的最后一次登陆时间</h4><p><img src="/images/64.png"></p>
<p><img src="/images/65.png"></p>
<p>❓为什么不是<code>2016/9/6 0:43:07</code>，</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>





</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">

  <div class="copyright">
    &copy; 
    <span itemprop="copyrightYear">2025</span>
    <span class="with-love">
      <i class="fa fa-heart"></i>
    </span>
    <span class="author" itemprop="copyrightHolder">loopy</span>
  </div>
  <div class="powered-by">Powered by <a href="https://hexo.io/" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/muse/" rel="noopener" target="_blank">NexT.Muse</a>
  </div>

    </div>
  </footer>

  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>
  <div class="sidebar-dimmer"></div>
  <div class="back-to-top" role="button" aria-label="Back to top">
    <i class="fa fa-arrow-up fa-lg"></i>
    <span>0%</span>
  </div>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>

</body>
</html>
